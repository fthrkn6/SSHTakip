#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
FRACAS Analiz SayfasÄ± - Data Flow GÃ¶sterimi

Sayfa: localhost:5000/fracas/
NasÄ±l Ã§alÄ±ÅŸÄ±yor? Tek tek gÃ¶sterim...
"""

print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           FRACAS ANALÄ°Z SAYFA - VERÄ° AKIÅI (Data Flow)                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–ˆ ADIM 1: Sayfa YÃ¼kleme - routes/fracas.py::index() Ã§aÄŸrÄ±lÄ±r
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“ Konum: routes/fracas.py, satÄ±r 195-238
  
  â”Œâ”€ index() route'u baÅŸlar
  â”‚
  â””â”€â–º df = load_ariza_listesi_data()
      â””â”€â–º logs/{{ current_project }}/ariza_listesi/ klasÃ¶rÃ¼nde
          Ariza_Listesi_*.xlsx dosyasÄ±nÄ± arar
          
          Ä°Ã§erik: 23 satÄ±r, 30 kolon
          â€¢ FRACAS ID, AraÃ§ No, AraÃ§ ModÃ¼l, Sistem, TedarikÃ§i
          â€¢ Tamir SÃ¼resi (MTTR), Garanti KapsamÄ±, vb.
          
      âœ“ BaÅŸarÄ±lÄ± ise: df yÃ¼klenir
      âœ— BaÅŸarÄ±sÄ±z ise: df = None
      
      â”œâ”€â–º EÄŸer df = None ise:
      â”‚   â””â”€â–º df = load_fracas_data()  # data/belgrad/ klasÃ¶rÃ¼nden
      â”‚
      â””â”€â–º data_source = 'ArÄ±za Listesi' (veya 'FRACAS')


â–ˆ ADIM 2: Veri Ä°ÅŸleme - Her bir grafik/tablo iÃ§in ayrÄ± hesaplamalar
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ 1ï¸âƒ£  TEMEL Ä°STATÄ°STÄ°KLER (calculate_basic_stats)                        â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  ğŸ“Š Ã‡Ä±ktÄ±: stats = {
    'total_failures': 23,           # len(df)
    'unique_vehicles': 13,          # df['AraÃ§ No'].nunique()
    'unique_modules': 5,            # df['AraÃ§ ModÃ¼l'].nunique()
    'total_suppliers': 10,          # df['TedarikÃ§i'].nunique()
    'class_a': 9,                   # ArÄ±za SÄ±nÄ±fÄ± daÄŸÄ±lÄ±mÄ±
    'class_b': 7,
    'class_c': 5,
    'class_d': 2,
    'warranty_claims': X            # Garanti KapsamÄ±'ndan
  }
  
  KullanÄ±lÄ± Kolon AdlarÄ±:
  â€¢ 'AraÃ§ No' â†’ vehicle_col
  â€¢ 'AraÃ§ ModÃ¼l' â†’ module_col  
  â€¢ 'TedarikÃ§i' â†’ supplier_col
  â€¢ 'ArÄ±za SÄ±nÄ±fÄ±' â†’ class_col
  â€¢ 'Garanti KapsamÄ±' â†’ warranty_col


  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ 2ï¸âƒ£  RAMS METRÄ°KLERÄ° (calculate_rams_metrics)                           â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  ğŸ“Š Ã‡Ä±ktÄ±: rams = {
    'mtbf': 1043.48,        # KM verilerine gÃ¶re hesaplanan MTBF (dakika)
                            # Formula: (avg_km_per_vehicle / 100) * 60
                            #          / (failures_per_vehicle)
                            
    'mttr': 52.3,           # df['MTTR (dk)'].mean()
                            # Tamir SÃ¼resi sÃ¼tunundan alÄ±nan ortalama
                            
    'mdt': 52.3,            # MDT = MTTR + MWT
    'mwt': None,            # Bekleme sÃ¼resi (varsa)
    
    'availability': 95.24,  # % = MTBF / (MTBF + MTTR) * 100
    'reliability': 95.0     # % = BaÅŸarÄ±lÄ± onarÄ±m oranÄ± (varsayÄ±lan)
  }
  
  KullanÄ±lan Kolon AdlarÄ±:
  â€¢ 'MTTR (dk)' veya 'Tamir SÃ¼resi' â†’ repair_col
  â€¢ 'Kilometre' â†’ km_col (MTBF hesaplamasÄ± iÃ§in)
  â€¢ 'AraÃ§ No' â†’ vehicle_col


  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ 3ï¸âƒ£  PARETO ANALÄ°ZÄ° (calculate_pareto_analysis) - 4 Grafik              â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  ğŸ“Š Ã‡Ä±ktÄ±: pareto = {
    
    'by_module': [              # AraÃ§ ModÃ¼l daÄŸÄ±lÄ±mÄ± (Bar + Line Chart)
      {'name': 'SB', 'count': 8, 'percentage': 34.8, 'cumulative': 34.8},
      {'name': 'T', 'count': 5, 'percentage': 21.7, 'cumulative': 56.5},
      ...
    ],
    
    'by_supplier': [            # TedarikÃ§i daÄŸÄ±lÄ±mÄ± (Bar + Line Chart)
      {'name': 'SKF', 'count': 7, 'percentage': 30.4, 'cumulative': 30.4},
      {'name': 'MÄ°NEL', 'count': 3, 'percentage': 13.0, 'cumulative': 43.4},
      ...
    ],
    
    'by_location': [            # Alt Sistem daÄŸÄ±lÄ±mÄ± (Pie Chart)
      {'name': 'YaÄŸlama TankÄ±', 'count': 6, ...},
      ...
    ],
    
    'by_failure_class': [       # ArÄ±za SÄ±nÄ±fÄ± daÄŸÄ±lÄ±mÄ± (Doughnut)
      {'name': 'A-Kritik/Emniyet Riski', 'count': 9, ...},
      ...
    ]
  }
  
  KullanÄ±lan Kolon AdlarÄ±:
  â€¢ 'AraÃ§ ModÃ¼l' â†’ module_col (value_counts())
  â€¢ 'TedarikÃ§i' â†’ supplier_col (value_counts())
  â€¢ 'Alt Sistem' â†’ location_col (value_counts())
  â€¢ 'ArÄ±za SÄ±nÄ±fÄ±' â†’ class_col (value_counts())


  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ 4ï¸âƒ£  TREND ANALÄ°ZÄ° (calculate_trend_analysis) - 3 Grafik               â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  ğŸ“Š Ã‡Ä±ktÄ±: trend = {
    
    'monthly': [                # AylÄ±k Trend (Line Chart)
      {'period': '2026-02', 'count': 23},  # Son 12 ay
      ...
    ],
    
    'by_hour': [                # Saatlik DaÄŸÄ±lÄ±m (Bar Chart) - 0-23
      {'hour': '00:00', 'count': 0},
      {'hour': '01:00', 'count': 0},
      ...
      {'hour': '10:00', 'count': 5},  # En Ã§ok saat 10'da arÄ±za
      ...
    ],
    
    'by_weekday': [             # HaftanÄ±n gÃ¼nÃ¼ (Line Chart)
      {'day': 'Pazartesi', 'count': 4},
      {'day': 'SalÄ±', 'count': 3},
      ...
    ]
  }
  
  KullanÄ±lan Kolon AdlarÄ±:
  â€¢ 'Tarih' â†’ date_col (pd.to_datetime)


  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ 5ï¸âƒ£  TEDARÄ°KÃ‡Ä° ANALÄ°ZÄ° (calculate_supplier_analysis) - Tablo           â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  ğŸ“Š Ã‡Ä±ktÄ±: supplier = {
    'performance': [            # TedarikÃ§i Tablo SatÄ±rlarÄ±
      {
        'name': 'SKF',
        'failure_count': 7,      # df[supplier_col == 'SKF']'in uzunluÄŸu
        'avg_repair_time': 48.5  # pd.to_numeric(MTTR sÃ¼tunu).mean()
      },
      {'name': 'MÄ°NEL', 'failure_count': 3, 'avg_repair_time': 45.0},
      ...
    ]
  }
  
  KullanÄ±lan Kolon AdlarÄ±:
  â€¢ 'TedarikÃ§i' â†’ supplier_col (groupby)
  â€¢ 'MTTR (dk)' â†’ repair_col (mean hesaplamasÄ±)


  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ 6ï¸âƒ£  MALÄ°YET ANALÄ°ZÄ° (calculate_cost_analysis)                         â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  ğŸ“Š Ã‡Ä±ktÄ±: cost = {
    'total_material': 0.0,      # Malzeme Maliyeti sÃ¼tunundan (varsa)
    'total_labor': 0.0,         # Ä°ÅŸÃ§ilik Maliyeti sÃ¼tunundan (varsa)
    'total_cost': 0.0,          # total_material + total_labor
    'by_vehicle': [],           # AraÃ§ bazlÄ± maliyet (varsa)
    'warranty_cost': 0,         # Garanti kapsamÄ±ndaki arÄ±za sayÄ±sÄ±
    'non_warranty_cost': 23     # Garanti dÄ±ÅŸÄ± arÄ±za sayÄ±sÄ±
  }
  
  NOT: ArÄ±za Listesi'nde malzeme/iÅŸÃ§ilik maliyeti sÃ¼tunu yok!
      Sadece Garanti kapsamÄ± bilgisi kullanÄ±lÄ±yor.
  
  KullanÄ±lan Kolon AdlarÄ±:
  â€¢ 'Garanti KapsamÄ±' â†’ warranty_col


â–ˆ ADIM 3: Template'e Veri GeÃ§iÅŸi
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  render_template('fracas/index.html',
    data_available=True,              # Veri var mÄ±?
    data_source='ArÄ±za Listesi',      # Hangi kaynaktan?
    stats=stats,                      # Temel Ä°statistikler
    rams=rams_metrics,                # RAMS Metrikleri
    pareto=pareto_data,               # Pareto Analizi (4 grafik)
    trend=trend_data,                 # Trend Analizi (3 grafik)
    supplier=supplier_data,           # TedarikÃ§i Tablosu
    cost=cost_data                    # Maliyet Analizi
  )


â–ˆ ADIM 4: Template RenderÄ± (templates/fracas/index.html)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€ KPI KartlarÄ±
  â”‚  â”œâ”€ {{ stats.total_failures }} (23)
  â”‚  â”œâ”€ {{ stats.unique_vehicles }} (13)
  â”‚  â”œâ”€ {{ stats.unique_modules }} (5)
  â”‚  â”œâ”€ {{ stats.total_suppliers }} (10)
  â”‚  â””â”€ {{ stats.warranty_claims }} (?)
  â”‚
  â”œâ”€ RAMS Metrikleri GÃ¶sterimi
  â”‚  â”œâ”€ MTBF: {{ rams.mtbf }} (1043.48 dakika)
  â”‚  â”œâ”€ MTTR: {{ rams.mttr }} (52.3 dakika)
  â”‚  â”œâ”€ Availability: {{ rams.availability }} (95.24%)
  â”‚  â””â”€ Reliability: {{ rams.reliability }} (95.0%)
  â”‚
  â”œâ”€ Chart 1: Pareto - AraÃ§ ModÃ¼l
  â”‚  â””â”€ Veri: {% for item in pareto.by_module %}{{ item.count }}, ...
  â”‚
  â”œâ”€ Chart 2: Pareto - TedarikÃ§i
  â”‚  â””â”€ Veri: {% for item in pareto.by_supplier %}{{ item.count }}, ...
  â”‚
  â”œâ”€ Chart 3: AylÄ±k Trend
  â”‚  â””â”€ Veri: {% for item in trend.monthly %}{{ item.count }}, ...
  â”‚
  â”œâ”€ Chart 4: Saatlik DaÄŸÄ±lÄ±m
  â”‚  â””â”€ Veri: {% for item in trend.by_hour %}{{ item.count }}, ...
  â”‚
  â”œâ”€ Chart 5: ArÄ±za SÄ±nÄ±fÄ±
  â”‚  â””â”€ Veri: {% for item in pareto.by_failure_class %}{{ item.count }}, ...
  â”‚
  â”œâ”€ Chart 6: ArÄ±za Konumu
  â”‚  â””â”€ Veri: {% for item in pareto.by_location %}{{ item.count }}, ...
  â”‚
  â””â”€ Tablo: TedarikÃ§i Performans
     â””â”€ {% for item in supplier.performance %}{{ item.name }}, ...


â–ˆ VERI KAYNAÄI Ã–ZETÄ°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“ Dosya Yolu:
     PRIMARY:  logs/belgrad/ariza_listesi/Ariza_Listesi_BELGRAD.xlsx
     FALLBACK: data/belgrad/FRACAS.xlsx
  
  ğŸ“„ Kolon HaritasÄ±:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ GrafiÄŸin AdÄ±               â”‚ KullanÄ±lan Kolon         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Toplam ArÄ±za (KPI)         â”‚ len(df)                  â”‚
  â”‚ AraÃ§ SayÄ±sÄ±                â”‚ 'AraÃ§ No'.nunique()      â”‚
  â”‚ ModÃ¼l SayÄ±sÄ±               â”‚ 'AraÃ§ ModÃ¼l'.nunique()   â”‚
  â”‚ TedarikÃ§i                  â”‚ 'TedarikÃ§i'.nunique()    â”‚
  â”‚ Garanti KaydÄ±              â”‚ 'Garanti KapsamÄ±' (evet) â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ MTBF                       â”‚ 'Kilometre' + formÃ¼l     â”‚
  â”‚ MTTR                       â”‚ 'MTTR (dk)'              â”‚
  â”‚ Availability               â”‚ MTBF / (MTBF+MTTR) * 100 â”‚
  â”‚ Reliability                â”‚ VarsayÄ±lan 95.0%         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Pareto ModÃ¼l               â”‚ 'AraÃ§ ModÃ¼l'             â”‚
  â”‚ Pareto TedarikÃ§i           â”‚ 'TedarikÃ§i'              â”‚
  â”‚ ArÄ±za Konumu               â”‚ 'Alt Sistem'             â”‚
  â”‚ ArÄ±za SÄ±nÄ±fÄ±               â”‚ 'ArÄ±za SÄ±nÄ±fÄ±'           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AylÄ±k Trend                â”‚ 'Tarih' (benzersiz ay)   â”‚
  â”‚ Saatlik DaÄŸÄ±lÄ±m            â”‚ 'Tarih' (saat 0-23)      â”‚
  â”‚ Hafta GÃ¼nÃ¼                 â”‚ 'Tarih' (gÃ¼n numarasÄ±)   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ TedarikÃ§i Tablosu          â”‚ 'TedarikÃ§i' + 'MTTR'     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â–ˆ KOD AKIÅI (Step by Step)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  1. User â†’ GET /fracas/
     â†“
  2. @bp.route('/') @login_required
     â†“
  3. load_ariza_listesi_data()
     â†’ os.path.join('logs', 'belgrad', 'ariza_listesi')
     â†’ pd.read_excel(..., sheet_name='Ariza Listesi', header=3)
     â†’ [23 rows, 30 columns] DataFrame
     â†“
  4. calculate_basic_stats(df)
     â†’ For 'AraÃ§ No':
       â€¢ EÄŸer df['AraÃ§ No'] varsa: nunique() = 13
       â€¢ EÄŸer yoksa: None
     â†“
  5. calculate_rams_metrics(df)
     â†’ df['Kilometre'].max() - df['Kilometre'].min() = KM aralÄ±ÄŸÄ±
     â†’ KM / arÄ±za sayÄ±sÄ± = MTBF
     â†“
  6. calculate_pareto_analysis(df)
     â†’ df['AraÃ§ ModÃ¼l'].value_counts() = [SB:8, T:5, SA:4, MC:4, M:1]
     â†’ KÃ¼mÃ¼latif yÃ¼zde hesapla
     â†“
  7. calculate_trend_analysis(df)
     â†’ df['Tarih'] â†’ pd.to_datetime() â†’ parse
     â†’ groupby(month) â†’ 1 satÄ±r (Feb 2026, 23 arÄ±za)
     â†“
  8. render_template() ile template'e geÃ§
     â†“
  9. HTML'de {% for item in pareto.by_module %}
     â†’ Jinja2 loop â†’ Chart.js dataset
     â†“
  10. Browser render â†’ Grafikler gÃ¶rÃ¼nÃ¼r


â–ˆ MÃœDAHALE NOKTALARI (DÃ¼zeltme YapÄ±labilecek Yerler)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  1. Kolon AdÄ± DeÄŸiÅŸirse:
     âœï¸ routes/fracas.py :: get_column() fonksiyonu
        â†’ possible_names listesine yeni ada ekle

  2. Veri KaynaÄŸÄ±nÄ± DeÄŸiÅŸtirmek Ä°Ã§in:
     âœï¸ routes/fracas.py :: load_ariza_listesi_data() / load_fracas_data()
        â†’ Dosya yolunu deÄŸiÅŸtir

  3. Grafik GÃ¶sterimini DeÄŸiÅŸtikmek Ä°Ã§in:
     âœï¸ templates/fracas/index.html
        â†’ Chart.js konfigÃ¼rasyonunu deÄŸiÅŸtir

  4. Hesaplama YÃ¶ntemini DeÄŸiÅŸtirmek Ä°Ã§in:
     âœï¸ routes/fracas.py :: calculate_* fonksiyonlarÄ±
        â†’ FormÃ¼lleri deÄŸiÅŸtir

""")
